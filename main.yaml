# -*- coding: utf-8 -*-
# vim: nu foldmethod=marker
# vim: expandtab shiftwidth=2 softtabstop=2 autoindent

---
  - name: Playbook to install my common programs and keep the computer up to date.
    hosts: all
    vars:
      common_programs:
        - vim
        - automake
        - git
        - texlive-full
        - boinc-client
        - cowsay
      programs_to_remove:
        - nano
        - emacs
    tasks:
    - name: Getting Variables from the secret
      include_vars: 
        file: secrets.yaml

    - name: Check for updates
      register: updatesys
      become: true
      package:
        update_cache: yes
        cache_valid_time: 3600 #1 hour, time in seconds
    - name: Install Common Programs
      become: true
      package:
        name: "{{common_programs}}"
        state: present
      notify:
      - Reboot to install
    - name: Remove Bloatware Programs
      become: true
      package:
        name: "{{programs_to_remove}}"
        state: absent
      notify:
      - Reboot to install

    - name: Upgrade all remaining packages
      register: updatesys
      become: true
      package:
        upgrade: full
      notify:
      - Reboot to install

    handlers:
      - name: Reboot to install
        become: true
        reboot:
        when: ansible_connection == "ssh"
